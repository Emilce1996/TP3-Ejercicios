package tp3ejercicio6;
import java.util.Objects;


public class TP3Ejercicio6 {

    private Queue<Documento> queuePrint; 
    private Documento docx;
    
    public static void main(String[] args) {
        (new TP3Ejercicio6()).open();
    }
    
    public void open(){
        char option;
        do{
            do{
                System.out.println("Estructura de Datos - Ejercicio 6");
                System.out.println("(1) Registro Manual");
                System.out.println("(2) Registro Automatico");
                System.out.println("(3) Imprimir");
                option = Helper.getChar();
            }while(validateOption(option));
        }while(run(option));
    }
         
    public void printDocuments(){
        Integer countColor = 0,countSizeOficio = 0;
        Documento documentMoreCopies = null,documentFewPages = null;       
        Boolean band=true;
        while(!this.queuePrint.isEmpty()){
            System.out.println("Imprimiendo...");   
            if(this.queuePrint.peek().getColor()==preferences.COLOR){
                countColor++;
            } 
            if(this.queuePrint.peek().getPaperSize()==paper.OFICIO){
                countSizeOficio++;
            }
            if(band){
               documentMoreCopies=this.queuePrint.peek();
               documentFewPages=this.queuePrint.peek();
               band=false;
            }else{
               if(this.queuePrint.peek().getNumberCopies()>documentMoreCopies.getNumberCopies()){
                   documentMoreCopies=this.queuePrint.peek();
               }
               if(this.queuePrint.peek().getNumberLeaves()<documentFewPages.getNumberLeaves()){
                   documentFewPages=this.queuePrint.peek();
               }
            }
            System.out.println(this.queuePrint.remove());
        }    
        System.out.println("Documentos imprimidos a color: "+countColor);
        System.out.println("Documentos imprimidos en tamaño oficio: "+countSizeOficio);
        System.out.println("Documento con mas copias: \n"+documentMoreCopies);
        System.out.println("Documento con menor hojas: \n"+documentFewPages);
    }
        
    public boolean run(char option){
        switch(option){
            case '1':
                registerManual();
                return true; 
            case '2':
                registerAutomatic();
                return true;
            case '3':
                printDocuments();
                return false;
            default:
                    return false;
        }
    }
    
    public boolean validateOption(char option){
        switch(option){
            case '1':
                return false;
            case '2':
                return false;
            case '3':
                if(Objects.isNull(this.queuePrint)){
                    System.out.println("Debe primero cargar documentos");
                    return true;
                }else{
                    return false;
                }
            default:
                System.out.println("Opcion no contemplada");
                return true;
        } 
    }
    
    public void registerManual(){
        String name;
        int numberLeaves,numberCopies;
        paper paperSize;
        preferences color;
        System.out.print("Ingrese la cantidad de documentos a registrar: ");
        int amount=Helper.getIntegerPositive();
        this.queuePrint = new Queue<>(amount);
        for(int i=0;i<amount;i++){
            System.out.print("Ingrese Nombre del Documento: ");
            name=Helper.getString()+".docx";
            System.out.print("Ingrese n° de Hojas: ");
            numberLeaves=Helper.getIntegerPositive();
            System.out.print("Ingrese tipo de Papel: ");
            paperSize=validatePaperSize();
            System.out.print("Ingrese n° de Copias: ");
            numberCopies=Helper.getIntegerPositive();
            System.out.print("Ingrese Preferencia (Color/Grises): ");
            color= validatePreferences();          
            this.docx = new Documento(name,numberLeaves,paperSize,numberCopies,color); 
            System.out.println((i+1)==1? ((i+1)+" documento en espera..."): ((i+1)+" documentos en espera..."));
            System.out.println(docx);
            this.queuePrint.add(docx);
        }            
    }
    
    public preferences validatePreferences(){
        boolean band = true;
        String colorString;
        preferences color= null;
        do{
            try {
                colorString=Helper.getString().toUpperCase();
                color= preferences.valueOf(colorString);
                band=false;
            } catch (Exception e) {
                System.out.println("Tipo de Preferencia no aceptado");
                System.out.print("Intentelo de nuevo: ");
            } 
        }while(band);
        return color;        
    }
               
    public paper validatePaperSize(){
        boolean band = true;
        String paperSizeString;
        paper type = null ;
        do{
            try {
                paperSizeString = Helper.getString().toUpperCase();
                type = paper.valueOf(paperSizeString);
                band = false;
            } catch (Exception e) {
                System.out.println("Tipo de papel no aceptado");
                System.out.print("Intentelo de nuevo: ");
            }          
        }while(band);
        return type;
    }
       
    public void registerAutomatic(){  
        int amount = Helper.random.nextInt(10)+1;
        this.queuePrint = new Queue<>(amount);
        for (int i = 0; i < amount; i++) {
            String name = someNames[Helper.random.nextInt(someNames.length)];
            int numberLeaves = Helper.random.nextInt(10)+1;
            int nRandom= Helper.random.nextInt(3);
            paper paperSize = nRandom==0? paper.A4 : nRandom==1? paper.OFICIO : paper.CARTA ;
            int numberCopies = Helper.random.nextInt(20);
            preferences color = Helper.random.nextInt(2)==0? preferences.COLOR : preferences.GRISES;
            this.docx = new Documento(name, numberLeaves, paperSize, numberCopies, color);
            System.out.println((i+1)==1? ((i+1)+" documento en espera..."): ((i+1)+" documentos en espera..."));
            System.out.println(docx);
            this.queuePrint.add(docx);
        }      
    }    
    
    private String[] someNames= {
            "Sistemas de Representación.docx",
            "Estructura de Datos y Algoritmos.docx",
            "El Principito.docx",
            "Curso Visual Basic para Principiantes.docx",
            "Hola Mundo! Basic.docx",
            "Algoritmos y Estructura de Datos.docx",
            "Inglés I.docx",
            "Análiss Matemático I.docx",
            "PacMan Visual Basic.docx",
            "Física I.docx",
            "Algebra y Geometría Analítica.docx",
            "Cómo Programar en C++ y Java.docx",
            "Cómo Programar en C#.docx",
            "Java Cómo Programar.docx",
            "Web Inicial Html.docx",
            "El Velero de Cristal.docx",
            "TIC.docx",
            "El Fantasma de Canterville.docx",
            "Estructuras de datos en Java.docx",
            "Estructura de datos en C++.docx",
            "Programación web Html y JavaScript.docx",
            "Química I.docx",
            "Guía Impresora Multifuncional Inalámbrica.docx",
            "Matemática Financiera I.docx",
            "Programar aplicaciones.docx",
            "Fundamentos de Programación en Java.docx",
            "Educación Cívica I.docx",
            "Historia Argentina.docx",
            "Geografía General.docx",
            "Programación en Ruby.docx",
            "El tutorial de Php.docx"  
    };    
}
